-----------------------------------------------	SCRIPT LIBRARY: TEXT HANDLING-----------------------------------------------Handler: Remove trailing and/or leading characters from stringson trim_line(this_text, trim_chars, trim_indicator)	-- 0 = beginning, 1 = end, 2 = both	set x to the length of the trim_chars	-- TRIM BEGINNING	if the trim_indicator is in {0, 2} then		repeat while this_text begins with the trim_chars			try				set this_text to characters (x + 1) thru -1 of this_text as string			on error				-- the text contains nothing but the trim characters				return ""			end try		end repeat	end if	-- TRIM ENDING	if the trim_indicator is in {1, 2} then		repeat while this_text ends with the trim_chars			try				set this_text to characters 1 thru -(x + 1) of this_text as string			on error				-- the text contains nothing but the trim characters				return ""			end try		end repeat	end if	return this_textend trim_line--Handler: trims unwanted characters from multiple lines--    Requires trim_line sub-routineon trim_paragraphs(this_text, trim_chars, trim_indicator)	set the paragraph_list to every paragraph of this_text	repeat with i from 1 to the count of paragraphs of this_text		set this_paragraph to item i of the paragraph_list		set item i of the paragraph_list to trim_line(this_paragraph, trim_chars, trim_indicator)	end repeat	set AppleScript's text item delimiters to return	set this_text to the paragraph_list as string	set AppleScript's text item delimiters to ""	return this_textend trim_paragraphs--Handler: Strips leading and trailing occurences of supplied characterto stripChar of char from someText	set tid to AppleScript's text item delimiters	set charToRemove to char	set AppleScript's text item delimiters to charToRemove	set TextItems to someText's text items		set a to 1	set b to (count TextItems)		--Determine the first item that is not charToRemove	repeat while (a < b) and ((count item a of TextItems) is 0)		set a to a + 1	end repeat		--Determine last item that is not charToRemove	repeat while (b > a) and ((count item b of TextItems) is 0)		set b to b - 1	end repeat		--Strip leading and trailing charToRemove items	set strippedText to text from text item a to text item b of someText	set AppleScript's text item delimiters to tid	strippedTextend stripChar--Handler: Converts string to all upper or lower case--    this_case of 0 yields lower case, 1 upper caseon change_case(this_text, this_case)	if this_case is 0 then		set the comparison_string to "ABCDEFGHIJKLMNOPQRSTUVWXYZ"		set the source_string to "abcdefghijklmnopqrstuvwxyz"	else		set the comparison_string to "abcdefghijklmnopqrstuvwxyz"		set the source_string to "ABCDEFGHIJKLMNOPQRSTUVWXYZ"	end if	set the new_text to ""	repeat with this_char in this_text		set x to the offset of this_char in the comparison_string		if x is not 0 then			set the new_text to (the new_text & character x of the source_string) as string		else			set the new_text to (the new_text & this_char) as string		end if	end repeat	return the new_textend change_case--Handler: Substitutes characters within text stringon replace_chars(this_text, search_string, replacement_string)	set AppleScript's text item delimiters to the search_string	set the item_list to every text item of this_text	set AppleScript's text item delimiters to the replacement_string	set this_text to the item_list as string	set AppleScript's text item delimiters to ""	return this_textend replace_chars--Handler: Splits string into array by delimiterto split(someText, delimiter)	set AppleScript's text item delimiters to delimiter	set someText to someText's text items	set AppleScript's text item delimiters to {""}	return someTextend split--Handler: Searches and replaces string within text blockto searchReplaceText(theText, searchString, replaceString)	set searchString to searchString as list	set replaceString to replaceString as list	set theText to theText as text		set oldTID to AppleScript's text item delimiters	repeat with i from 1 to count searchString		set AppleScript's text item delimiters to searchString's item i		set theText to theText's text items		set AppleScript's text item delimiters to replaceString's item i		set theText to theText as text	end repeat	set AppleScript's text item delimiters to oldTID		return theTextend searchReplaceText